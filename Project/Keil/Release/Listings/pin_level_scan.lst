C51 COMPILER V9.60.7.0   PIN_LEVEL_SCAN                                                    08/01/2025 15:47:47 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE PIN_LEVEL_SCAN
OBJECT MODULE PLACED IN .\Release\Objects\pin_level_scan.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\..\User\pin_level_scan.c LARGE OPTIMIZE(9,SIZE) BROWSE ORDER INTVECTO
                    -R(0X000C) INCDIR(..\..\Libraries\Include;..\..\User;..\..\User\lib;..\..\Hardware) INTERVAL(3) DEBUG OBJECTEXTEND PRINT(
                    -.\Release\Listings\pin_level_scan.lst) OBJECT(.\Release\Objects\pin_level_scan.obj)

line level    source

   1          #include "pin_level_scan.h"
   2          
   3          u16 pin_level_scan_time_cnt = 0;
   4          
   5          void pin_level_scan_config(void)
   6          {
   7   1          p21_input_config(); // è¿œå…‰ç¯çŠ¶æ€å¯¹åº”çš„å¼•è„š
   8   1          p22_input_config(); // å³è½¬å‘ç¯çŠ¶æ€å¯¹åº”çš„å¼•è„š
   9   1          // p23_input_config(); // åˆ¹è½¦çŠ¶æ€å¯¹åº”çš„å¼•è„š
  10   1          p25_input_config(); // å·¦è½¬å‘ç¯çŠ¶æ€å¯¹åº”çš„å¼•è„š
  11   1      
  12   1          p27_input_config(); // 6æ¡£å¯¹åº”çš„å¼•è„š
  13   1          p30_input_config(); // 5æ¡£å¯¹åº”çš„å¼•è„š
  14   1          p14_input_config(); // 4æ¡£å¯¹åº”çš„å¼•è„š
  15   1          p13_input_config(); // 3æ¡£å¯¹åº”çš„å¼•è„š
  16   1          p10_input_config(); // 2æ¡£å¯¹åº”çš„å¼•è„š
  17   1          p07_input_config(); // 1æ¡£å¯¹åº”çš„å¼•è„š
  18   1          p06_input_config(); // ç©ºæŒ¡å¯¹åº”çš„å¼•è„š
  19   1      
  20   1          // æ£€æµ‹æ•…éšœçŠ¶æ€çš„å¼•è„š:
  21   1          P2_MD0 &= ~(GPIO_P20_MODE_SEL(0x03)); // è¾“å…¥æ¨¡å¼
  22   1          P2_PU |= GPIO_P20_PULL_UP(0x01);      // ä¸Šæ‹‰
  23   1      
  24   1          // æµ‹è¯•ç”¨
  25   1          // P0_MD0 &= ~(GPIO_P02_MODE_SEL(0x03)); // è¾“å…¥æ¨¡å¼
  26   1          // P0_PU |= GPIO_P02_PULL_UP(0x01);      // ä¸Šæ‹‰
  27   1      }
  28          
  29          // å¼•è„šç”µå¹³æ‰«æï¼Œéƒ½æ˜¯ä½ç”µå¹³æœ‰æ•ˆ
  30          void pin_level_scan(void)
  31          {
  32   1          // å¦‚æœåˆ°äº†æ‰«ææ—¶é—´ï¼Œå†æ›´æ–°æŒ¡ä½ã€è½¬å‘ç¯å’Œåˆ¹è½¦çš„çŠ¶æ€
  33   1          if (pin_level_scan_time_cnt >= PIN_LEVEL_SCAN_TIME_MS)
  34   1          {
  35   2              pin_level_scan_time_cnt = 0;
  36   2      
  37   2      #if 0  // åˆ¹è½¦æ£€æµ‹
                      // if (PIN_DETECT_BRAKE)
                      // {
                      //     // å¦‚æœæ²¡æœ‰åˆ¹è½¦
                      //     fun_info.brake = OFF;
                      // }
                      // else
                      // {
                      //     // å¦‚æœæœ‰åˆ¹è½¦
                      //     fun_info.brake = ON;
                      // }
              
                      // flag_get_brake = 1;
              #endif // åˆ¹è½¦æ£€æµ‹
  51   2      
  52   2      #if 1
  53   2              if (PIN_DETECT_LEFT_TURN)
C51 COMPILER V9.60.7.0   PIN_LEVEL_SCAN                                                    08/01/2025 15:47:47 PAGE 2   

  54   2              {
  55   3                  // å¦‚æœå·¦è½¬å‘ç¯æœªå¼€å¯
  56   3                  fun_info.left_turn = OFF;
  57   3              }
  58   2              else
  59   2              {
  60   3                  // å¦‚æœå·¦è½¬å‘ç¯å¼€å¯
  61   3                  fun_info.left_turn = ON;
  62   3              }
  63   2              flag_get_left_turn = 1;
  64   2      
  65   2              if (PIN_DETECT_RIGHT_TURN)
  66   2              {
  67   3                  // å¦‚æœå³è½¬å‘ç¯æœªå¼€å¯
  68   3                  fun_info.right_turn = OFF;
  69   3              }
  70   2              else
  71   2              {
  72   3                  // å¦‚æœå³è½¬å‘ç¯å¼€å¯
  73   3                  fun_info.right_turn = ON;
  74   3              }
  75   2              flag_get_right_turn = 1;
  76   2      
  77   2              if (PIN_DETECT_HIGH_BEAM)
  78   2              {
  79   3                  // å¦‚æœè¿œå…‰ç¯æœªå¼€å¯
  80   3                  fun_info.high_beam = OFF;
  81   3              }
  82   2              else
  83   2              {
  84   3                  // å¦‚æœè¿œå…‰ç¯å¼€å¯
  85   3                  fun_info.high_beam = ON;
  86   3              }
  87   2              flag_get_high_beam = 1;
  88   2      #endif
  89   2      
  90   2              // ä»¥æœ€ä½æŒ¡ä½ä¼˜å…ˆï¼Œå½“æœ€ä½æ¡£æœ‰ä¿¡å·æ—¶ï¼Œä¸ç®¡å…¶ä»–æŒ¡ä½çš„ä¿¡å·ï¼Œç›´æ¥ä»¥æœ€ä½
             -æ¡£çš„ä¸ºä¸»
  91   2              if (0 == PIN_DETECT_NEUTRAL_GEAR)
  92   2              {
  93   3                  // ç©ºæŒ¡
  94   3                  fun_info.gear = GEAR_NEUTRAL;
  95   3              }
  96   2              else if (0 == PIN_DETECT_FIRST_GEAR)
  97   2              {
  98   3                  // ä¸€æ¡£
  99   3                  fun_info.gear = GEAR_FIRST;
 100   3              }
 101   2              else if (0 == PIN_DETECT_SECOND_GEAR)
 102   2              {
 103   3                  // äºŒæ¡£
 104   3                  fun_info.gear = GEAR_SECOND;
 105   3              }
 106   2              else if (0 == PIN_DETECT_THIRD_GEAR)
 107   2              {
 108   3                  // ä¸‰æ¡£
 109   3                  fun_info.gear = GEAR_THIRD;
 110   3              }
 111   2              else if (0 == PIN_DETECT_FOURTH_GEAR)
 112   2              {
 113   3                  // å››æ¡£
 114   3                  fun_info.gear = GEAR_FOURTH;
C51 COMPILER V9.60.7.0   PIN_LEVEL_SCAN                                                    08/01/2025 15:47:47 PAGE 3   

 115   3              }
 116   2              else if (0 == PIN_DETECT_FIFTH_GEAR)
 117   2              {
 118   3                  // äº”æ¡£
 119   3                  fun_info.gear = GEAR_FIFTH;
 120   3              }
 121   2              else if (0 == PIN_DETECT_XIXTH_GEAR)
 122   2              {
 123   3                  // å…­æ¡£
 124   3                  fun_info.gear = GEAR_SIXTH;
 125   3              }
 126   2      
 127   2              // printf("cur gear %bu\n", fun_info.gear);
 128   2              flag_get_gear = 1;
 129   2      
 130   2              if (0 == PIN_DETECT_MALFUNCTION)
 131   2              {
 132   3                  // å¦‚æœæ£€æµ‹åˆ°äº†æ•…éšœ
 133   3                  fun_info.flag_is_detect_malfunction = 1;
 134   3      
 135   3                  // æ²¡æœ‰å¼•è„šæ£€æµ‹absçš„çŠ¶æ€ï¼Œè¿™é‡Œæ£€æµ‹åˆ°æ•…éšœåï¼Œä¹Ÿé¡ºä¾¿è®¾ç½®absçš„çŠ¶æ€
 136   3                  fun_info.flag_is_detect_abs = 1;
 137   3              }
 138   2              else
 139   2              {
 140   3                  // å¦‚æœæœªæ£€æµ‹åˆ°æ•…éšœ
 141   3                  fun_info.flag_is_detect_malfunction = 0;
 142   3      
 143   3                  // æ²¡æœ‰å¼•è„šæ£€æµ‹absçš„çŠ¶æ€ï¼Œè¿™é‡Œæ›´æ–°æ•…éšœçš„çŠ¶æ€åï¼Œä¹Ÿé¡ºä¾¿è®¾ç½®absçš„çŠ¶æ
             -€
 144   3                  fun_info.flag_is_detect_abs = 0;
 145   3              }
 146   2      
 147   2              //   printf("cur malfunction %bu\n", fun_info.flag_is_detect_malfunction);
 148   2      
 149   2              flag_update_malfunction_status = 1;
 150   2          }
 151   1      
 152   1          // if () // ACCå¼•è„šæ£€æµ‹ï¼Œæ£€æµ‹åˆ°é«˜ç”µå¹³ï¼ŒP03ä¹Ÿè¾“å‡ºé«˜ç”µå¹³ï¼Œæ£€æµ‹åˆ°ä½ç”µå¹³ï¼Œè®©P03
             -è¾“å‡ºä½ç”µå¹³
 153   1          // if (P04)
 154   1          // {
 155   1          //     // æ£€æµ‹åˆ°ACCä¸ºé«˜ç”µå¹³,
 156   1          //     P03 = 1;
 157   1          // }
 158   1          // else
 159   1          // {
 160   1          //     P03 = 0;
 161   1          // }
 162   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    211    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      2    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
